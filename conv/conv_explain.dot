digraph conv_layer {
    rankdir=BT;
    node [shape=circle, width=0.8, fixedsize=true];
    edge [fontname=Arial, fontsize=11];
    subgraph cluster_FC {
        P1 [style=dashed];
        X1, X2, X3, X4, X5, X6, X7;
        P2 [style=dashed];

        Y1, Y2, Y3, Y4;
       
        P1 -> Y1 [label="W0"];
        X1 -> Y1 [label="W1"];
        X2 -> Y1 [label="W2"];
        X2 -> Y2 [label="W0"];
        X3 -> Y2 [label="W1"];
        X4 -> Y2 [label="W2"];
        X4 -> Y3 [label="W0"];
        X5 -> Y3 [label="W1"];
        X6 -> Y3 [label="W2"];
        X6 -> Y4 [label="W0"];
        X7 -> Y4 [label="W1"];
        P2 -> Y4 [label="W2"];
        
        label="feed-forward conv";
        color=blue
    }
    
    subgraph cluster_c_d_x {
        P11 [label="P1", style=dashed];
        Y11 [label="Y1"];
        P33 [label="", style=dashed];
        Y22 [label="Y2"];
        P44 [label="", style=dashed];
        Y33 [label="Y3"];
        P55 [label="",style=dashed];
        Y44 [label="Y4"];
        P22 [label="P2", style=dashed];

        X11 [label="X1"];
        X22 [label="X2"];
        X33 [label="X3"];
        X44 [label="X4"];
        X55 [label="X5"];
        X66 [label="X6"];
        X77 [label="X7"];
    }
}



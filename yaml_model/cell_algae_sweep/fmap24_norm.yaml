obj_name: 'cell_algae_4cat_norm'
epoch: 40
batch: 30
h5_train: /root/data_part/train.h5
h5_valid: /root/data_part/valid.h5
h5_test: /root/data_part/test.h5
checkpoint: 'yaml_model/4cat_norm_fmap24.npz'
input_image_size_y: 511
input_image_size_x: 511
input_num_channels: 4
inc_rate: 1.0
dec_rate: 1.0
momentum: 0.9
alpha: 0.002
cost: CE
shuffle: true

network:
  - name: conv1
    type: CONVOLUTION
    num_channels: 24
    kernel_size: 16     # (511 + 2*0 - 16)/5 + 1 = 100
    stride: 5
    padding: 0
    init_wt: 0.1

  - name: maxpool1
    type: MAXPOOL
    num_channels: 24
    kernel_size: 2      # (100 + 2*0 - 2)/2 + 1 = 50
    stride: 2
    padding: 0

  - name: conv2
    type: CONVOLUTION
    num_channels: 48
    kernel_size: 6      # (50 + 2*3 - 6)/2 + 1 = 26
    stride: 2
    padding: 3
    init_wt: 0.1

  - name: maxpool2
    type: MAXPOOL
    num_channels: 48    # (26 + 2*0 - 2)/2 + 1 = 13
    kernel_size: 2
    stride: 2
    padding: 0

  - name: conv3
    type: CONVOLUTION
    num_channels: 96
    kernel_size: 4      # (13 + 2*0 - 4)/1 + 1 = 10
    stride: 1
    padding: 0
    init_wt: 0.1

  - name: maxpool3
    type: MAXPOOL
    num_channels: 96   # (10 + 2*0 - 2)/2 + 1 = 5
    kernel_size: 2
    stride: 2
    padding: 0

  - name: fc1
    type: FC_SIG
    num_channels: 2400
    init_wt: 0.02

  - name: output
    type: FC_SOFTMAX
    num_channels: 4
    init_wt: 0.02
